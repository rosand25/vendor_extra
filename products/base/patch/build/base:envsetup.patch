From 083a5958963d7dd82b2491feb3653d2ede760670 Mon Sep 17 00:00:00 2001
From: sub77 <darfpunk@gmx.de>
Date: Wed, 21 Dec 2016 14:37:49 +0000
Subject: [PATCH] envsetup

Change-Id: If0b1435a14a6d343ca0f769684da9bd5d6f779de
Signed-off-by: sub77 <darfpunk@gmx.de>
---
 envsetup.sh | 22 ++++++++++++++++++++++
 1 file changed, 22 insertions(+)

diff --git a/envsetup.sh b/envsetup.sh
index 454d80d..3c854ca 100644
--- a/envsetup.sh
+++ b/envsetup.sh
@@ -239,12 +239,34 @@ function printconfig()
     get_build_var report_config
 }
 
+function patchcommontree()
+{
+for f in `test -d vendor && find -L vendor/extra/products/common*/patch -maxdepth 1 -name 'apply.sh' 2> /dev/null`
+do
+    echo -e ${CL_YLW}"\nPatching common-tree -> $f\n"${CL_RST}
+    . $f
+done
+unset f
+}
+
+function patchdevicetree()
+{
+for f in `test -d device && find -L device/*/$CUSTOM_BUILD/patch -maxdepth 4 -name 'apply.sh' 2> /dev/null`
+do
+    echo -e ${CL_YLW}"\nPatching device-tree -> $f\n"${CL_RST}
+    . $f
+done
+unset f
+}
+
 function set_stuff_for_environment()
 {
     settitle
     set_java_home
     setpaths
     set_sequence_number
+    patchcommontree
+    patchdevicetree
 
     export ANDROID_BUILD_TOP=$(gettop)
     # With this environment variable new GCC can apply colors to warnings/errors
-- 
2.1.4

