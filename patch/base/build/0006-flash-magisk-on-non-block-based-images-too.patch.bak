From 94eb77472dc696c49cee65be409b8f1a82c3029c Mon Sep 17 00:00:00 2001
From: sub77 <sub77@ymail.com>
Date: Thu, 23 Feb 2017 18:34:22 +0100
Subject: [PATCH] flash magisk on non block based images, too

Change-Id: If50a28977f654c8a6f5a4797b0efc432071661b3
---
 tools/releasetools/ota_from_target_files.py | 15 +++++++--------
 1 file changed, 7 insertions(+), 8 deletions(-)

diff --git a/tools/releasetools/ota_from_target_files.py b/tools/releasetools/ota_from_target_files.py
index b0e64f836..709866efc 100755
--- a/tools/releasetools/ota_from_target_files.py
+++ b/tools/releasetools/ota_from_target_files.py
@@ -755,14 +755,13 @@ else if get_stage("%(bcb_dev)s") == "3/3" then
   script.Print("Flashing boot.img")
   script.WriteRawImage("/boot", "boot.img")
 
-  if block_based:
-    script.Print(" ")
-    script.Print("Flashing Magisk...")
-    script.Print(" ")
-    common.ZipWriteStr(output_zip, "magisk/magisk.zip",
-                   ""+input_zip.read("SYSTEM/addon.d/magisk.zip"))
-    script.FlashMagisk()
-    script.Print(" ")
+  script.Print(" ")
+  script.Print("Flashing Magisk...")
+  script.Print(" ")
+  common.ZipWriteStr(output_zip, "magisk/magisk.zip",
+                 ""+input_zip.read("SYSTEM/addon.d/magisk.zip"))
+  script.FlashMagisk()
+  script.Print(" ")
   script.ShowProgress(0.2, 10)
   script.Print("Enjoy OMNI ROM!");
   device_specific.FullOTA_InstallEnd()
-- 
2.11.1

